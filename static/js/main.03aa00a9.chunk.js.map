{"version":3,"sources":["App.tsx","reportWebVitals.ts","index.tsx"],"names":["currentFrame","index","toString","padStart","html","document","documentElement","App","imageCacheRef","useRef","canvasRef","imgRef","Image","timeRef","Date","currentFrameRef","startFrameRef","destinationFrameRef","animationIsOn","animate","context","timeElapsed","current","timeProgress","x","Math","floor","pow","updateImage","requestAnimationFrame","drawImage","useEffect","i","preloadImg","src","canvas","width","height","getContext","onload","window","addEventListener","scrollFraction","scrollTop","scrollHeight","innerHeight","frameIndex","max","min","frameCount","id","ref","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"kMAIMA,G,WAAe,SAACC,GAAD,+IAC+GA,EAAMC,WAAWC,SAAS,EAAG,KAD5I,UAoBfC,EAAOC,SAASC,gBAyEPC,MArEf,WACE,IAAMC,EAAgBC,iBAAmB,IACnCC,EAAYD,iBAAY,MACxBE,EAASF,iBAAY,IAAIG,OACzBC,EAAUJ,iBAAa,IAAIK,MAC3BC,EAAkBN,iBAAe,GACjCO,EAAgBP,iBAAe,GAC/BQ,EAAsBR,iBAAe,GACrCS,EAAgBT,kBAAgB,GAEhCU,EAAU,SAAVA,EAAWC,GACf,IACMC,GADY,IAAIP,MACMD,EAAQS,QAC9BC,EAAeF,EAfD,IAgBpB,GAAIA,EAhBgB,IAiBlBH,EAAcI,SAAU,MAD1B,CAIA,IA9BkBE,EA8BZxB,EAAeyB,KAAKC,OA9BRF,EA8B2BD,GA7BxC,EAAIE,KAAKE,IAAI,EAAIH,EAAG,KA6BqCP,EAAoBK,QAAUN,EAAcM,SAAWN,EAAcM,UACnIJ,EAAcI,SAAU,EACxBM,EAAYR,EAASpB,GACrB6B,uBAAsB,kBAAMV,EAAQC,QAGhCQ,EAAc,SAACR,EAAcnB,GACjCc,EAAgBO,QAAUrB,EAC1BmB,EAAQU,UAAUtB,EAAcc,QAAQrB,GAAQ,EAAG,IAsCrD,OAnCA8B,qBAAU,WAGR,IAAI,IAAIC,EAAI,EAAGA,GAnCA,IAmCiBA,IAAK,CACnC,IAAMC,EAAa,IAAIrB,MACvBqB,EAAWC,IAAMlC,EAAagC,GAC9BxB,EAAcc,QAAQU,GAAKC,EAE7B,IAAME,EAASzB,EAAUY,QACzB,GAAIa,EAAQ,CACVA,EAAOC,MAAQ,KACfD,EAAOE,OAAS,IAChB,IAAMjB,EAAUe,EAAOG,WAAW,MAClC3B,EAAOW,QAAQY,IAAMlC,EAAae,EAAgBO,SAClDX,EAAOW,QAAQiB,OAAO,WACpBnB,EAAQU,UAAUnB,EAAOW,QAAS,EAAG,IAEvCkB,OAAOC,iBAAiB,UAAU,WAChC,IAEMC,EAFYtC,EAAKuC,YACDvC,EAAKwC,aAAeJ,OAAOK,aAAe,GAE1DC,EAAarB,KAAKsB,IAAI,EAC1BtB,KAAKuB,IACHC,IACAxB,KAAKC,MAxDE,IAwDIgB,KAEfzB,EAAoBK,QAAUwB,EACzB5B,EAAcI,UACjBT,EAAQS,QAAU,IAAIR,KACtBE,EAAcM,QAAUP,EAAgBO,QACxCO,uBAAsB,kBAAMV,EAAQC,aAIzC,IAED,wBAAQ8B,GAAG,iBAAiBC,IAAKzC,KC/EtB0C,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,6BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCHdQ,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEF1D,SAAS2D,eAAe,SAM1BZ,K","file":"static/js/main.03aa00a9.chunk.js","sourcesContent":["import React, {useRef, useEffect} from 'react';\nimport logo from './logo.svg';\nimport './App.css';\n\nconst currentFrame = (index:number):string => (\n  `https://www.apple.com/105/media/us/airpods-pro/2019/1299e2f5_9206_4470_b28e_08307a42f19b/anim/sequence/large/01-hero-lightpass/${index.toString().padStart(4, '0')}.jpg`\n)\n\nconst easeOutExpo = (x: number): number => {\n  return x === 1 ? 1 : 1 - Math.pow(2, -10 * x);\n};\n\nconst easeOutQuint = (x: number): number => {\n  return 1 - Math.pow(1 - x, 5);\n}\n\nconst easeOutQuart = (x: number): number => {\n  return 1 - Math.pow(1 - x, 4);\n}\n\nconst easeOutCubic = (x: number): number => {\n  return 1 - Math.pow(1 - x, 3);\n}\n\nconst html = document.documentElement;\nconst frameCount = 147;\nconst animateDuration = 450; //millisecond\n\nfunction App() {\n  const imageCacheRef = useRef<Array<any>>([]);\n  const canvasRef = useRef<any>(null);\n  const imgRef = useRef<any>(new Image());\n  const timeRef = useRef<Date>(new Date());\n  const currentFrameRef = useRef<number>(1);\n  const startFrameRef = useRef<number>(1);\n  const destinationFrameRef = useRef<number>(1);\n  const animationIsOn = useRef<Boolean>(false);\n\n  const animate = (context:any) => {\n    const now: Date = new Date();\n    const timeElapsed = +now - +timeRef.current;\n    const timeProgress = timeElapsed/animateDuration;\n    if (timeElapsed > animateDuration) {\n      animationIsOn.current = false;\n      return;\n    }\n    const currentFrame = Math.floor(easeOutQuart(timeProgress) * (destinationFrameRef.current - startFrameRef.current) + startFrameRef.current);\n    animationIsOn.current = true;\n    updateImage(context, currentFrame);\n    requestAnimationFrame(() => animate(context))\n  }\n\n  const updateImage = (context: any, index: number) => {\n    currentFrameRef.current = index;\n    context.drawImage(imageCacheRef.current[index], 0, 0);\n  }\n\n  useEffect(() => {\n    //preload images\n    //TODO: there must be a better way\n    for(let i = 0; i <= frameCount; i++) {\n      const preloadImg = new Image();\n      preloadImg.src = currentFrame(i);\n      imageCacheRef.current[i] = preloadImg;\n    }\n    const canvas = canvasRef.current;\n    if (canvas) {\n      canvas.width = 1158;\n      canvas.height = 770;\n      const context = canvas.getContext('2d');\n      imgRef.current.src = currentFrame(currentFrameRef.current);\n      imgRef.current.onload=function(){\n        context.drawImage(imgRef.current, 0, 0);\n      }\n      window.addEventListener('scroll', () => {\n        const scrollTop = html.scrollTop;\n        const maxScrollTop = (html.scrollHeight - window.innerHeight) / 4;\n        const scrollFraction = scrollTop / maxScrollTop;\n        const frameIndex = Math.max(1,\n          Math.min(\n            frameCount - 1,\n            Math.floor(scrollFraction * frameCount)\n        ));\n        destinationFrameRef.current = frameIndex;\n        if (!animationIsOn.current) {\n          timeRef.current = new Date();\n          startFrameRef.current = currentFrameRef.current;\n          requestAnimationFrame(() => animate(context));\n        }\n      })\n    }\n  }, [])\n  return (\n    <canvas id=\"hero-lightpass\" ref={canvasRef} />\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);  \n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n}\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}